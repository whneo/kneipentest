<?php

$term = isset($_GET['term']) ? trim($_GET['term']) : '';

// zum Testen
//$term = "y";

if (!empty($term)) {
    include './db_connect.inc.php';
    // $suchstring enthält den zu suchenden Teilstring
    // sql statement mit prepared statements
    $stmt = $db->prepare("SELECT Kneipenname FROM kneipen WHERE Kneipenname LIKE ? or Art LIKE ? or Kommentar LIKE ?");
    $stmt->bindValue(1, "%$term%", PDO::PARAM_STR);
    $stmt->bindValue(2, "%$term%", PDO::PARAM_STR);
    $stmt->bindValue(3, "%$term%", PDO::PARAM_STR);
    $stmt->execute();
    $rows = $stmt->fetchAll(PDO::FETCH_OBJ);
    // Array $names soll die Namen der Kneipen zurückgeben
    $names = [];
    foreach ($rows as $row) {
        $names[] = $row->Kneipenname;
    }

//  zum Testen
//    echo '<pre>';
//    print_r($names);
//    echo '</pre>';

    echo json_encode($names);
}
